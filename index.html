<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- for better experience on phones -->
     <meta name="theme-color" content="#4CAF50">
    <title>Pet Health Tracker</title>
        <!-- Primary meta tags -->
    <meta name="description" content="Track and manage your pet's health records, reminders, and medical history with Pet Health Tracker">
        <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Pet Health Tracker - Manage Your Pet's Health">
    <meta property="og:description" content="Create and share your pet's complete health profile with vaccination reminders, medical history, and emergency information">
    <meta property="og:image" content="https://drkimogad.github.io/Pet-Health-Tracker/banner/Image.png">
    <!-- Canonical URL -->
    <link rel="canonical" href="https://drkimogad.github.io/Pet-Health-Tracker/">
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Pet Health Tracker - Manage Your Pet's Health">
    <meta name="twitter:description" content="Create and share your pet's complete health profile with vaccination reminders, medical history, and emergency information">
    <meta name="twitter:image" content="https://drkimogad.github.io/Pet-Health-Tracker/banner/Image.png">    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://accounts.google.com">
    <link rel="preconnect" href="https://apis.google.com">
    <link rel="preload" href="https://accounts.google.com/gsi/client" as="script">
    
    <!-- Enhanced CSP with Nonce -->
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';

  script-src 'self' 'unsafe-inline' 'unsafe-eval'
    https://www.gstatic.com
    https://cdn.jsdelivr.net
   https://cdnjs.cloudflare.com
    https://apis.google.com
    https://accounts.google.com
    https://www.googleapis.com
    https://unpkg.com;

  style-src 'self' 'unsafe-inline'
    https://fonts.googleapis.com
    https://accounts.google.com;

  connect-src 'self'
    https://www.googleapis.com
    https://firestore.googleapis.com
    https://*.googleapis.com
    https://identitytoolkit.googleapis.com
    https://accounts.google.com
    https://api.cloudinary.com
    https://us-central1-pet-health-tracker-4ec31.cloudfunctions.net
    https://lottiefiles.com
    https://cdn.lottiefiles.com;

  img-src 'self' blob: data:
    https://*.googleusercontent.com
    https://images.unsplash.com
    https://www.google.com
    https://res.cloudinary.com;

  font-src 'self' https://fonts.gstatic.com;

  frame-src https://accounts.google.com https://lottiefiles.com;

  object-src 'none';
  base-uri 'self';
  form-action 'self';
  worker-src 'self';
">

<script>
  window.handleScriptError = (error) => {
    console.error('Script failed to load:', error);
    document.getElementById('authContainer').innerHTML = `
      <div class="error-message">
        <h2>Application Error</h2>
        <p>Failed to load required resources. Please refresh or try again later.</p>
      </div>
    `;
  };
</script>
    
  <!-- Google Sign-In -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js"></script>     <!-- can't be cached locally as a library -->

  
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    <link rel="manifest" href="./manifest.json">
    <link rel="stylesheet" href="./styles.css">

    <!-- Local copies of external libraries -->
<script src="./js/lib/cloudinary-core-shrinkwrap.min.js"></script>
<script src="./js/lib/qrcode.min.js"></script>
<script src="./js/lib/html2canvas.min.js"></script>
<script src="./js/lib/jszip.min.js"></script>    <!-- for ZIP exports -->
<script src="./js/lib/jspdf.umd.min.js"></script> <!-- for PDF exports -->
<script src="./js/lib/lottie-player.js"></script>

<script src="./js/lib/firebase-app-compat.js"></script>
<script src="./js/lib/firebase-auth-compat.js"></script>
<script src="./js/lib/firebase-firestore-compat.js"></script>
<script src="./js/lib/firebase-functions-compat.js"></script>
    
</head>
<body>
    <noscript>
        <div class="offline-warning">
            <h2>JavaScript Required</h2>
            <p>Please enable JavaScript to use this application.</p>
            <p>When offline, you can still view cached content.</p>
        </div>
    </noscript>
    <div class="background-container">
    <!-- Header containermoved outsideauth containerso it can showin dashboard as well -->
          <div class="header-container"> 
             <h1>Pet Health Tracker</h1>
            <h2>Your pet wellness hub </h2> 
        </div>  
            <!-- Auth Container  has 2 things now-->
    <div id="authContainer">
            <!-- Bouncing ball Google Sign-In button  moved outsideauth container-->
            <!-- becauseof overflowhiddenin other elemebts will affect its visibility-->
   <div id="googleSignInBtnWrapper" class="bouncing-ball-container">
     <p class="auth-message">Sign in with your Google account</p>
    <div id="googleSignInButton" class="bouncing-ball"></div>
    <div class="auth-legal">
        By signing in, you agree to our 
        <a href="./privacy.html" target="_blank">Terms of Service</a> and 
        <a href="./terms.html" target="_blank">Privacy Policy</a>.
    </div>
   </div>

             <!-- Email/Password Sign-Up Form inside auth welcome section -->
<div id="emailSignupWrapper" class="email-auth-wrapper signup-mode" style="display:none;">
    <p class="auth-message">Sign up here ‚¨áÔ∏è</p>
  <form id="emailSignupForm" class="email-signup-form">
    <div class="form-group">
      <label for="signupEmailInput">Email</label>
      <input type="email" id="signupEmailInput" name="signupEmail" placeholder="you@example.com" required autocomplete="username">
    </div>
    <div class="form-group">
      <label for="signupPasswordInput">Password</label>
      <input type="password" id="signupPasswordInput" name="signupPassword" placeholder="Your password" required autocomplete="new-password">
    </div>
          <!-- ADD THIS CONFIRM PASSWORD FIELD -->
    <div class="form-group">
      <label for="signupConfirmInput">Confirm Password</label>
      <input type="password" id="signupConfirmInput" name="signupConfirm" placeholder="Confirm your password" required autocomplete="new-password">
    </div>
      
    <button type="submit" id="emailSignupBtn" class="signup-btn">Sign Up</button>
       <p class="auth-legal">
        By signing up, you agree to our 
        <a href="./terms.html" target="_blank">Terms of Service</a>
        & <a href="./privacy.html" target="_blank">Privacy Policy</a>.
      </p>
      
      <p class="auth-switch">
        Already have an account?
        <a href="#" id="goToLogin">Sign in</a>
      </p>

  </form>
 
</div>


          <!-- Email/Password Login Form inside auth welcome section-->
<div id="emailLoginWrapper" class="email-auth-wrapper signin-mode">
   <p class="auth-message">üê∂‚ÄØüê±‚ÄØüê¶‚ÄØüê∞</p>
  <form id="emailLoginForm" class="email-login-form">
    <div class="form-group">
      <label for="emailInput">Email</label>
      <input type="email" id="emailInput" name="email" placeholder="you@example.com" required autocomplete="username">
    </div>
    <div class="form-group">
      <label for="passwordInput">Password</label>
      <input type="password" id="passwordInput" name="password" placeholder="Your password" required autocomplete="current-password">
    </div>
      <!-- ADD FORGOT PASSWORD LINK HERE -->
    <div class="forgot-password">
      <a href="#" id="forgotPasswordLink">Forgot password?</a>
    </div>
      
    <button type="submit" id="emailLoginBtn" class="login-btn">Sign In</button>
        <p class="auth-legal">
           By signing in, you agree to our 
           <a href="./terms.html" target="_blank">Terms of Service</a>
          & <a href="./privacy.html" target="_blank">Privacy Policy</a>.
       </p>
      
        <p class="auth-switch">
          No account?
        <a href="#" id="goToSignup">Create one</a>
       </p>
      
   </form>

</div>

        

     <div class="auth-welcome-section">   
        <!-- New Small Lottie Container USED AS A WELCOMING MESSAGE -->
        <div class="pet-animation-container" style="width: 80%; margin: 20px auto; aspect-ratio: 4/1; max-width: 800px;">
        <lottie-player
            src="./lottiefiles/Welcome.json"
            background="transparent"
            speed="1"
            style="width: 100%; height: 100%; object-fit: contain;"
            loop
            autoplay>
        </lottie-player>       
        </div>
    </div>      
                
        <!-- 1. Full-page background Lottie (replacing banner) -->
<div id="fullPageBanner" class="banner-wrapper fullpage-lottie-container">
    <lottie-player
        src="./lottiefiles/momhugpets.json"
        background="transparent"
        speed="1"
        loop
        autoplay
        style="width: 100%; height: 100%;"
    ></lottie-player>
</div>        
</div>  <!-- closes auth container -->

       <!-- Auth loader works for showLoading function for aut.js self contained for authentication -->
<div id="processing-loader" 
     style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000;">
  <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center;">      
    <!-- üåÄ Default Cat Spinner -->
    <lottie-player
      id="loader-animation1" 
      src="./lottiefiles/Cat.json"
      background="transparent"
      speed="2"
      style="width: 170px; height: 170px;"
      loop
      autoplay>
    </lottie-player>
      <!-- Auth-specific message -->
    <p id="auth-loader-message" style="color:#fff; margin-top:1rem; font-size:1rem; font-weight:500;">Loading...</p>
    </div>
</div>
        
 <!-- ================================================-->
<!-- Dashboard Loader (Paws Animation) for some functions -->
<!-- ========================================== -->
<div id="dashboard-loader" 
     style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000;">
  <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center;">
    
    <!-- üêæ Paws animation for dashboard operations -->
    <lottie-player
      id="dashboard-loader-animation"
      src="./lottiefiles/paws.json"
      background="transparent"
      speed="2"
      style="width: 170px; height: 170px; display:none;"
      loop
      autoplay>
    </lottie-player>
      
      <!-- üåÄ CSS Spinner Fallback (ADD THIS) -->
    <div id="css-spinner-fallback" class="css-spinner-fallback"></div>
      
    <!-- Loader messages -->
    <!-- id in helper to fetch right message is dashboard-loader-message key -->
    <p id="dashboard-loader-loading" class="loader-text">Loading...</p>
      
    <p id="dashboard-loader-saving" class="loader-text" style="display:none;">Saving...</p>
    <p id="dashboard-loader-success-saving" class="loader-text" style="display:none;">Profile saved successfully!</p>
    <p id="dashboard-loader-error-saving" class="loader-text" style="display:none;">‚ùå Failed to save profile. Please try again.</p>

     <p id="dashboard-loader-updating" class="loader-text" style="display:none;">Updating...</p>
    <p id="dashboard-loader-success-updating" class="loader-text" style="display:none;">Profile updated successfully!</p>
    <p id="dashboard-loader-error-updating" class="loader-text" style="display:none;">‚ùå Failed to update profile. Please try again.</p>
      
    <p id="dashboard-loader-deleting" class="loader-text" style="display:none;">Deleting...</p>
    <p id="dashboard-loader-success-deleting" class="loader-text" style="display:none;">Profile deleted successfully!</p>
    <p id="dashboard-loader-error-deleting" class="loader-text" style="display:none;">‚ùå Failed to delete profile. Please try again.</p>

    <p id="dashboard-loader-exporting" class="loader-text" style="display:none;">Exporting...</p>
    <p id="dashboard-loader-success-exporting" class="loader-text" style="display:none;">‚úÖ all pet cards exported successfully!</p>
    <p id="dashboard-loader-error-exporting" class="loader-text" style="display:none;">‚ùå Export failed. Please try again.</p>
     <!-- qr, inviteFriends and showdetails modal using notificationsystem ftom auth.js-->
  </div>
</div>
        
    <main id="dashboard" class="hidden"> <!-- We'll control visibility via CSS class -->
        <div class="dashboard-actions">
            <button id="addPetProfileBtn" class="primary-action">+ New Profile</button>
            <button id="logoutButton" class="primary-action">Logout</button>
       </div>
            <div class="form-container">
                <form id="petList" class="hidden">
                    <fieldset>
                        <legend>Basic Information</legend>
                        <label for="petName">Pet Name:</label>
                        <input type="text" id="petName" name="petName" required>

                        <fieldset>
                            <legend>Pet Photo</legend>
                            <label for="petPhoto">Upload Photo:</label>
                            <input type="file" id="petPhoto" name="petPhoto" accept="image/*">
                            <img id="petPhotoPreview" src="#" alt="Pet Photo Preview">
                        </fieldset>

                        <label for="breed">Breed:</label>
                        <input type="text" id="breed" name="breed" required>
                        <label for="age">Age:</label>
                        <input type="text" id="age" name="age" required>
                        <label for="weight">Weight:</label>
                        <input type="text" id="weight" name="weight" required>
                        <label for="petType">Pet Type:</label>
                        <select id="petType" name="petType" required>
                            <option value="">Select type...</option>
                            <option value="Dog">Dog</option>
                            <option value="Cat">Cat</option>
                            <option value="Bird">Bird</option>
                            <option value="Rabbit">Rabbit</option>
                            <option value="Fish">Fish</option>
                            <option value="Reptile">Reptile</option>
                            <option value="Other">Other</option>
                        </select>
                        <label for="petGender">Gender:</label>
                        <select id="petGender" name="petGender" required>
                            <option value="">Select gender...</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Unknown">Unknown</option>
                        </select>
                    </fieldset>

                    <fieldset>
                        <legend>Microchip Information</legend>
                        <label for="microchipId">Microchip ID:</label>
                        <input type="text" id="microchipId" name="microchipId">
                        <label for="microchipDate">Implant Date:</label>
                        <input type="date" id="microchipDate" name="microchipDate">
                        <label for="microchipVendor">Vendor:</label>
                        <input type="text" id="microchipVendor" name="microchipVendor">
                    </fieldset>

                    <fieldset>
                        <legend>Health Information</legend>
                        <label for="allergies">Allergies:</label>
                        <textarea id="allergies" name="allergies"></textarea>
                        <label for="medicalHistory">Medical History:</label>
                        <textarea id="medicalHistory" name="medicalHistory"></textarea>
                        <label for="dietPlan">Diet Plan:</label>
                        <textarea id="dietPlan" name="dietPlan"></textarea>
                        <label for="moodSelector">Current Mood:</label>
                        <select id="moodSelector" name="mood">
                            <option value="">Select mood...</option>
                            <option value="üòä Happy">Happy</option>
                            <option value="üò¢ Sad">Sad</option>
                            <option value="üò° Angry">Angry</option>
                            <option value="ü•± Tired">Tired</option>
                            <option value="ü§í Sick">Sick</option>
                        </select>
                    </fieldset>

                    <fieldset>
                        <legend>Emergency Contact</legend>
                        <label for="emergencyContactName">Name:</label>
                        <input type="text" id="emergencyContactName" name="emergencyContactName">
                        <label for="emergencyContactPhone">Phone:</label>
                        <input type="tel" id="emergencyContactPhone" name="emergencyContactPhone">
                        <label for="emergencyContactRelationship">Relationship:</label>
                        <input type="text" id="emergencyContactRelationship" name="emergencyContactRelationship" placeholder="Vet/Owner/etc.">
                    </fieldset>

                    <fieldset class="reminders-section">
                        <legend>Reminders</legend>
                        <label for="birthdayReminder">Birthday Reminder:</label>
                        <input type="datetime-local" id="birthdayReminder" name="birthdayReminder">
                        <label for="vaccinationsAndDewormingReminder">Vaccinations/Deworming:</label>
                        <input type="datetime-local" id="vaccinationsAndDewormingReminder" name="vaccinationsAndDewormingReminder">
                        <label for="medicalCheckupsReminder">Medical Check-ups:</label>
                        <input type="datetime-local" id="medicalCheckupsReminder" name="medicalCheckupsReminder">
                        <label for="groomingReminder">Grooming:</label>
                        <input type="datetime-local" id="groomingReminder" name="groomingReminder">
                    </fieldset>
                    
                    <div class="form-actions">
                       <button type="submit" class="primary-action">Save Pet Profile</button>
                          <!-- Cancel button will be injected here by JS -->
                    </div>
                </form>
            </div>

            <section class="saved-profiles">
                <h3>Saved Pet Profiles</h3>
                <ul id="savedProfilesList"></ul>
            </section>
        </main>
    </div>

    <footer>
    <p>&copy; 2024 Pet Health Tracker</p>
    <div class="legal-links">
        <a href="./privacy.html" target="_blank">Privacy Policy</a> | 
        <a href="./terms.html" target="_blank">Terms of Service</a>
    </div>
    </footer>
    
        <!-- Scripts (Optimized Order) -->
    <script src="./js/auth.js" defer></script>
    <script src="./js/utils.js" defer></script>
    <script src="./js/dashboard.js" defer></script>

</body>
</html>
